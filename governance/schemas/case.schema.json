{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "canonical://casebook/schema/v1.0/case",
  "title": "Canonical Case Schema",
  "type": "object",

  "required": [
    "case_id",
    "core_claim",
    "lifecycle",
    "structural_risk",
    "typical_loophole",
    "learning_objectives"
  ],

  "properties": {
    "case_id": {
      "type": "string",
      "pattern": "^CASE-[0-9]{3}$"
    },

    "core_claim": {
      "type": "string",
      "minLength": 20,
      "description": "Irreducible core claim of the case"
    },

    "lifecycle": {
      "type": "array",
      "minItems": 6,
      "items": {
        "$ref": "./lifecycle.schema.json"
      }
    },

    "structural_risk": {
      "type": "string",
      "description": "System-level risk created by this decision pattern"
    },

    "typical_loophole": {
      "type": "string",
      "description": "How responsibility usually escapes"
    },

    "learning_objectives": {
      "type": "object",
      "required": ["pdca", "bloom"],
      "properties": {
        "pdca": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string" }
        },
        "bloom": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string" }
        }
      },
      "additionalProperties": false
    }
  },

  "additionalProperties": false
}
